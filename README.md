# Система автоматического формирования модели кредитного скоринга

Этот проект представляет собой комплексную систему автоматического построения пайплайнов машинного обучения для задач кредитного скоринга с использованием **генетического алгоритма** для оптимизации конфигурации всего пайплайна.

## 🎯 Ключевые особенности

- **Автоматическая оптимизация** всего ML-пайплайна от предобработки до выбора модели
- **Генетический алгоритм** для поиска оптимальных конфигураций (20-генная хромосома)
- **Комплексная предобработка**: импутация, кодирование, балансировка, масштабирование
- **Множественные алгоритмы**: от логистической регрессии до нейронных сетей
- **Продвинутое кодирование**: LSA, Word2Vec для категориальных признаков
- **Целевая метрика**: PR AUC (оптимальна для несбалансированных данных)
- **Автоматические отчеты**: метрики, графики, важность признаков

## 🏗️ Архитектура системы

```
┌─────────────────────────────────────────────────────────────┐
│                    ГЕНЕТИЧЕСКИЙ АЛГОРИТМ                    │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐           │
│  │ Популяция   │→│ Оценка      │→│ Эволюция    │→ Лучший   │
│  │ хромосом    │ │ фитнеса     │ │ поколений   │  пайплайн │
│  └─────────────┘ └─────────────┘ └─────────────┘           │
└─────────────────────────────────────────────────────────────┘
                           │
                   ┌───────▼────────┐
                   │ ПАЙПЛАЙН (20 генов) │
                   └────────┬───────┘
            ┌──────────────┼──────────────┐
            ▼              ▼              ▼
    ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
    │ПРЕДОБРАБОТКА│ │МОДИФИКАЦИЯ  │ │ ОБУЧЕНИЕ    │
    │• Импутация  │ │• Балансировка│ │• Модели ML  │
    │• Кодирование│ │• Масштабиров.│ │• Валидация  │
    │• Выбросы    │ │             │ │• Метрики    │
    └─────────────┘ └─────────────┘ └─────────────┘
```

## 📁 Структура проекта

```
project/
│
├── src/
│   ├── main.py                    # Центральный модуль с конфигурацией
│   ├── ga_optimizer.py            # Генетический алгоритм
│   ├── pipeline_processor.py      # Обработчик ML-пайплайна
│   │
│   ├── preprocessing/              # Модули предобработки
│   │   ├── data_loader.py         # Загрузка данных
│   │   ├── data_preprocessor.py   # Импутация и кодирование
│   │   ├── outlier_remover.py     # Удаление выбросов
│   │   └── resampler.py           # Балансировка классов
│   │
│   ├── modeling/
│   │   └── model_trainer.py       # Обучение и оценка моделей
│   │
│   └── utils/
│       ├── data_analysis.py       # Анализ данных
│       └── results_saver.py       # Сохранение результатов
│
├── datasets/                      # Исходные датасеты
├── results/                       # Обработанные данные
├── research/                      # Результаты экспериментов
├── requirements.txt
└── README.md
```

## 🧬 Генетический алгоритм

### Структура хромосомы (20 генов)
```
Гены 0-2:   Импутация      (метод + 2 гиперпараметра)
Гены 3-5:   Выбросы        (метод + 2 гиперпараметра)  
Гены 6-8:   Ресемплинг     (метод + 2 гиперпараметра)
Гены 9-11:  Кодирование    (метод + 2 гиперпараметра)
Гены 12-14: Масштабирование (метод + 2 гиперпараметра)
Гены 15-19: Модель         (тип + 4 гиперпараметра)
```

### Параметры ГА
- **Размер популяции**: 10 особей
- **Поколения**: 8 итераций
- **Элитизм**: 25% лучших особей
- **Мутация**: 10% вероятность
- **Селекция**: турнирная (размер турнира: 3)

## 🛠️ Поддерживаемые методы

### Импутация пропущенных значений
- **KNN Imputer** (n_neighbors: 3-15)
- **Median/Mode** импутация
- **MissForest** импутация (n_estimators: 30-200)

### Кодирование категориальных признаков
- **One-Hot Encoding** (с ограничением кардинальности)
- **Label Encoding** 
- **LSA (Latent Semantic Analysis)** (n_components: 5-75)
- **Word2Vec** эмбеддинги (dimensions: 25-150)

### Удаление выбросов
- **Isolation Forest** (contamination: auto-0.15)
- **IQR Method** (multiplier: 1.5-3.0)
- **Без обработки**

### Балансировка классов
- **Random OverSampling**
- **SMOTE** (k_neighbors: 3-9)
- **ADASYN** (k_neighbors: 3-9)
- **Без балансировки**

### Масштабирование
- **StandardScaler** (настраиваемые параметры)
- **MinMaxScaler**
- **Без масштабирования**

### Модели машинного обучения
- **Logistic Regression** (C, penalty, solver, class_weight)
- **Random Forest** (n_estimators, max_depth, min_samples_split/leaf)
- **Gradient Boosting** (n_estimators, learning_rate, max_depth, subsample)
- **Neural Networks** (Keras: архитектура, dropout, learning_rate, batch_size)

## 🚀 Установка и использование

### 1. Клонирование репозитория
```bash
git clone <repository_url>
cd project
```

### 2. Создание виртуального окружения
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows
```

### 3. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 4. Подготовка данных
Поместите ваши датасеты в папку `datasets/`:
- Поддерживаются форматы CSV
- Возможны отдельные train/test файлы или один файл для автоматического разделения
- Поддерживаются датасеты для решения задачи классификации (бинарной/многоклассовой)

### 5. Запуск оптимизации

#### Для одиночного запуска с фиксированными параметрами:
```bash
python src/main.py
```

#### Для запуска генетического алгоритма:
```bash
python src/ga_optimizer.py
```

## 📊 Результаты

Система автоматически создает:

### Структуру результатов
```
results/
└── [dataset_name]/
    └── [experiment_config]/
        ├── processed_data.csv
        └── metrics.json

research/
└── [dataset_name]/
    └── [experiment_config]/
        ├── learning_curves.png
        ├── feature_importance.png
        └── model_metrics.json
```

### Метрики качества
- **PR AUC** (основная целевая метрика)
- **ROC AUC**
- **F1-Score**
- **Accuracy**
- **Precision/Recall**

## 🔧 Конфигурация

### Настройка генетического алгоритма
В файле `src/ga_optimizer.py` можно изменить:
```python
POPULATION_SIZE = 10      # Размер популяции
NUM_GENERATIONS = 8       # Количество поколений  
ELITISM_PERCENT = 0.25    # Процент элитизма
MUTATION_RATE = 0.1       # Вероятность мутации
TOURNAMENT_SIZE = 3       # Размер турнира
```

### Добавление новых методов
Система спроектирована для легкого расширения:
1. Добавьте новый метод в соответствующий preprocessor
2. Обновите мапинги в `main.py`
3. Добавьте гиперпараметры в конфигурацию

## 🎯 Целевые задачи

Система оптимизирована для:
- **Кредитный скоринг**
- **Задачи бинарной классификации**
- **Несбалансированные датасеты**
- **Смешанные типы данных** (числовые + категориальные)

## 📈 Производительность

- Автоматическая оптимизация **20 параметров** пайплайна
- Поддержка **4 типов моделей** с индивидуальной настройкой
- **Продвинутые методы** кодирования (LSA, Word2Vec)
- **Целевая метрика PR AUC** для несбалансированных данных

## 🔬 Исследовательские возможности

- Анализ важности признаков
- Кривые обучения моделей
- Статистика распределений
- Корреляционный анализ
- Визуализация результатов оптимизации

## 📋 Требования

- Python 3.7+
- NumPy, Pandas, Scikit-learn
- TensorFlow (для нейронных сетей)
- Gensim (для Word2Vec)
- Imbalanced-learn (для балансировки)
- Matplotlib, Seaborn (для визуализации)

Полный список зависимостей см. в `requirements.txt`.

## 🤝 Вклад в проект

Система спроектирована для расширения. Вы можете добавить:
- Новые методы предобработки
- Дополнительные модели ML
- Альтернативные метрики оптимизации
- Улучшенные стратегии ГА

---

**Автоматизация ML-пайплайнов для кредитного скоринга с генетической оптимизацией** 🧬🎯 